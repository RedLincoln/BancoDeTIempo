<!-- Generated by Vue on Rails https://github.com/vueonrails/vueonrails -->
<!-- The corresponding pack is app/javascript/packs/transaction_form.js -->
<!-- Generate another component part like this by running command `rails generate vue something` -->

<template>
  <div id="transaction">
    <span class="open_petition" @click="toggleShow">Pedir</span>
    <transition>
      <form v-if="show" class="form" @submit.prevent>
        <div class="field">
          <label for="time_petition"></label>
          <input type="text" id="time_petition" class="time_petition" ref="time_petition" placeholder="Horario: eg. 07/07/2020 13:00">
        </div>
        <div class="field">
          <label for="additional_information"></label>
          <textarea id="additional_information" class="additional_information" ref="additional_information" placeholder="Añade información extra"></textarea>
        </div>
        <div class="actions">
          <button class="send_petition" @click="sendPetition">Enviar</button>
        </div>
      </form>
    </transition>
  </div>
</template>

<script>
  import axios from 'axios'
  import railsFlash from "../railsFlash";

  export default {
    data: function() {
      return {
        show: false
      };
    },
    methods: {
      toggleShow: function () {
        this.show = !this.show
      },
      sendPetition: function () {
        axios.post(this.$createTransactionPath, {
          transaction: {
            datetime: this.$refs.datetime,
            additional_information: this.$refs.additional_information
          }
        }).then(response => railsFlash.notice(response.notice)).catch(err => railsFlash.alert(err.message))
      }
    }
  };
</script>

<style scoped>
</style>